function cgpApiInit(){document.querySelectorAll(".cgp-custom-api-search-results").forEach((a=>{getCgpApiData({lang:a.getAttribute("data-lang"),htmlwrap:a.querySelector(".sc-cgp-api-ft-data"),apiurl:a.getAttribute("data-api-url"),resulturl:a.getAttribute("data-result-url"),showpagination:parseInt(a.getAttribute("data-show-pagination")),numitemsperpage:parseInt(a.getAttribute("data-num-items-page")),maxitems:parseInt(a.getAttribute("data-max-items"))},{en:{org:"Organisation: ",pub:"Published: ",view:"View Record",nodata:"We're sorry, something went wrong, please refresh the page.",na:"N/A"},fr:{org:"Organisation : ",pub:"Publié  : ",view:"Afficher l'enregistrement",nodata:"Nous sommes désolés, quelque chose s'est mal passé. Veuillez rafraîchir la page",na:"N/A"}})}))}function getCgpApiData(a,t){fetch(a.apiurl).then((function(a){return a.json()})).then((function(e){let r=e.Items.slice(0,a.maxitems);showCgpApiData(a,t,r)})).catch((function(e){showCgpApiError(a,t),console.warn(t[a.lang].nodata,e)}))}function showCgpApiError(a,t){let e="";e+='<div class="sc-cgp-api-ft-data-results sc-cgp-api-error"',e+=`<p>${t[a.lang].nodata}</p>`,e+="</div>",a.htmlwrap.innerHTML=e}function showCgpApiData(a,t,e){let r,i="",s="",n="",l="",g="",p=1,o="",c=1;i+='<div class="sc-cgp-api-ft-data-results" aria-live="polite">',e.forEach((e=>{n=e.title,l=e.id,g=e.organisation,r=e.published,resUrl=`${a.resulturl}?id=${l}&lang=${a.lang}`,resDesc=e.description,resDescExcerpt=resDesc.replace(/^(.{400}[^\s]*).*/,"$1")+" [...]",o="card data-card show",1===a.showpagination&&c>a.numitemsperpage&&(o="card data-card hide"),i+=`<div class="${o}" data-page-group="${p}">`,i+='<div class="card-body">',i+=`<h3 class="card-title"><a href="${resUrl}" target="_blank">${n}</a></h3>`,i+='<div class="card-meta">',i+=`<p class="card-meta-item card-meta-item-org"><strong>${t[a.lang].org}</strong>${g}</p>`,i+=`<p class="card-meta-item card-meta-item-pub-date"><strong>${t[a.lang].pub}</strong>${r}</p>`,i+="</div>",i+='<div class="card-text">',i+=`<p>${resDescExcerpt}</p>`,i+="</div>",i+=`<p class="text-right"><a href="${resUrl}" target="_blank" class="btn btn-sm card-button" aria-label="${n}">${t[a.lang].view}<i class="fas fa-long-arrow-alt-right"></i></a></p>`,i+="</div>",i+="</div>",c%a.numitemsperpage==0&&p++,c++})),i+="</div>";let u=0;if(e.length>a.numitemsperpage&&(u=Math.floor(e.length/a.numitemsperpage)),u>1&&1===a.showpagination){let a=1;for(s+=`<nav class="sc-cgp-api-ft-data-pagination" aria-label="Pagination Navigation" data-current-page-group="page-group-${a}">`,s+='<ul class="pagination-list">';a<=u;)s+=1==a?`<li class="pagination-list-item"><button class="pagination-btn current" data-page-num="${a}" aria-label="Current Page - Page ${a}" aria-current="true" aria-disabled="true">${a}</button></li>`:`<li class="pagination-list-item"><button class="pagination-btn" data-page-num="${a}" aria-label="Goto Page ${a}" aria-current="false">${a}</button></li>`,a++;s+="</ul>",s+="</nav>"}a.htmlwrap.innerHTML=i+s,pagintaionEl=a.htmlwrap.querySelector(".sc-cgp-api-ft-data-pagination"),u>1&&1===a.showpagination&&makeCgpAPIPagination(pagintaionEl)}function makeCgpAPIPagination(a){a.addEventListener("click",(function(t){if(t.target.hasAttribute("data-page-num")){t.preventDefault();let e=t.target.getAttribute("data-page-num"),r=a.closest(".sc-cgp-api-ft-data").querySelectorAll(".card"),i=a.querySelectorAll(".pagination-btn");for(btn of i)label=btn.getAttribute("aria-label"),btn.setAttribute("aria-label",label.replace("Current Page - ","")),btn.setAttribute("aria-disabled",!1),btn.setAttribute("aria-current",!1),btn.classList.remove("current");t.target.setAttribute("aria-label","Current Page - Page "+e),t.target.setAttribute("aria-current",!0),t.target.setAttribute("aria-disabled",!0),t.target.classList.add("current");for(let a of r){let t=a.getAttribute("data-page-group");a.classList.remove("show"),a.classList.add("hide"),e==t&&(a.classList.remove("hide"),a.classList.add("show"))}}}))}cgpApiInit();
//# sourceMappingURL=cgp-api-sc-ft-data-min.js.map